/* =================================================================
   DRAWER STYLES
   Glass panel, drawer transitions, states
   ================================================================= */

/* --- GLASS PANEL --- */
.glass-panel {
    background: rgba(0, 0, 0, 0.95);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.9);
}

/* Drawer Transition - iOS spring curve, GPU accelerated */
#list-drawer {
    transition: transform 0.3s cubic-bezier(0.32, 0.72, 0, 1),
                height 0.3s cubic-bezier(0.32, 0.72, 0, 1),
                opacity 0.25s ease-out;
    will-change: transform, height, opacity;
}

/* Desktop drawer states - fully hide/show via search bar toggle */
@media (min-width: 640px) {
    #list-drawer {
        height: calc(100 * var(--vh) - 100px);
        max-height: none;
    }
    /* Closed: fully hidden */
    #list-drawer.drawer-peek,
    #list-drawer.drawer-closed {
        opacity: 0;
        transform: translateY(-20px);
        pointer-events: none;
    }
    /* Open: fully visible */
    #list-drawer.drawer-open {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
    }
}

/* Mobile drawer states - 2 snap points only: peek and open */
@media (max-width: 639px) {
    #list-drawer {
        height: calc(88 * var(--vh)) !important;
        max-height: none !important;
        opacity: 1 !important;
        /* Position at bottom of screen */
        position: fixed !important;
        bottom: 16px !important;
        left: 12px !important;
        right: 12px !important;
        top: auto !important;
    }
    /* Peek state: shows drag handle + 2 cards (~140px visible) */
    #list-drawer.drawer-peek {
        transform: translateY(calc(100% - 140px)) !important;
        pointer-events: auto !important;
    }
    /* Open state: full drawer (85% screen) */
    #list-drawer.drawer-open {
        transform: translateY(0) !important;
        pointer-events: auto !important;
    }
}

/* Backdrop overlay when drawer is fully open */
#drawer-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s cubic-bezier(0.32, 0.72, 0, 1);
    z-index: 899;
}
#drawer-backdrop.active {
    opacity: 1;
    pointer-events: auto;
}

/* iOS rubber-banding fix + dynamic viewport height */
#list-content {
    overscroll-behavior: contain;
    max-height: calc(65 * var(--vh));
}
@media (min-width: 640px) {
    #list-content { max-height: calc(100 * var(--vh) - 200px); }
}

/* Safe area insets for iPhone X+ */
.glass-panel.rounded-full { padding-top: max(0.375rem, env(safe-area-inset-top)); }
#list-drawer { padding-bottom: env(safe-area-inset-bottom); }

/* --- DRAG HANDLE --- */
.drag-handle {
    /* 48px minimum touch target (WCAG AAA compliant) */
    min-width: 48px;
    min-height: 48px;
    /* Visual feedback on drag */
    transition: transform 0.1s ease-out;
}

.drag-handle:active {
    transform: translateX(-50%) scale(1.05);
}

.drag-handle span {
    transition: background-color 0.15s ease, transform 0.15s ease;
}

.drag-handle:active span {
    background-color: rgba(255, 255, 255, 0.7);
    transform: scaleX(1.1);
}
