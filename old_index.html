<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MicMap - NYC Comedy Open Mics</title>
    <meta name="description" content="Find comedy open mics near you in NYC. Filter by day, time, borough, and more.">

    <!-- =================================================================== -->
    <!-- FONTS -->
    <!-- =================================================================== -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- =================================================================== -->
    <!-- TAILWIND CSS -->
    <!-- =================================================================== -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- =================================================================== -->
    <!-- LEAFLET MAP LIBRARY -->
    <!-- =================================================================== -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Leaflet Marker Clustering Plugin -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

    <!-- =================================================================== -->
    <!-- CUSTOM STYLES -->
    <!-- =================================================================== -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<!-- ======================================================================= -->
<!-- MAIN APP CONTAINER -->
<!-- ======================================================================= -->
<div id="app-container" class="h-screen w-screen overflow-hidden relative">

    <!-- ================================================================== -->
    <!-- LEFT PANEL (List View) -->
    <!-- ================================================================== -->
    <div id="left-panel" class="absolute lg:relative bg-[var(--surface-medium)] overflow-y-auto z-10 shadow-2xl">

        <!-- Panel Drag Handle (Mobile Only) -->
        <div id="panel-handle" class="lg:hidden w-12 h-1 bg-[var(--border-color)] rounded-full mx-auto mb-3 cursor-grab active:cursor-grabbing"></div>

        <!-- Header -->
        <div class="px-6 pt-6 pb-5 border-b border-[var(--border-color)]">
            <h1 class="text-4xl font-bold text-[var(--text-primary)] mb-2 tracking-tight">MicMap</h1>
            <p class="text-sm text-[var(--text-secondary)] font-medium">NYC Comedy Open Mics</p>
            <div id="results-counter" class="mt-3 px-3 py-1.5 bg-[var(--surface-light)] rounded-lg inline-block">
                <span class="text-xs font-semibold text-[var(--text-tertiary)]">
                    <span id="results-count" class="text-[var(--brand-blue)] font-bold">0</span> mics found
                    <span id="filter-badge" class="ml-2 bg-blue-500 text-white text-xs font-bold px-2 py-0.5 rounded-full hidden"></span>
                </span>
            </div>
        </div>

        <!-- ============================================================== -->
        <!-- FILTERS SECTION -->
        <!-- ============================================================== -->
        <div class="px-6 py-5 space-y-5 border-b border-[var(--border-color)]">

            <!-- Search Input -->
            <div class="relative">
                <input
                    type="text"
                    id="location-search-input"
                    placeholder="Search by name, location, or tag..."
                    class="w-full px-4 py-3 rounded-lg bg-[var(--surface-light)] border border-[var(--border-color)] text-[var(--text-primary)] text-sm placeholder-[var(--text-tertiary)] focus:ring-2 focus:ring-[var(--brand-blue)] focus:border-transparent transition-all"
                >
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute right-3 top-3.5 text-[var(--text-tertiary)]">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </div>

            <!-- Sort Dropdown -->
            <div>
                <label for="sort-filter" class="block text-sm font-medium text-[var(--text-secondary)] mb-2.5">Sort by</label>
                <select id="sort-filter" class="w-full px-4 py-3 rounded-lg bg-[var(--surface-light)] border border-[var(--border-color)] text-[var(--text-primary)] text-sm focus:border-[var(--brand-blue)] transition-colors">
                    <option value="distance">Distance (Near to Far)</option>
                    <option value="time">Start Time (Earliest First)</option>
                    <option value="popularity">Popularity (Most Comics)</option>
                </select>
            </div>

            <!-- Near Me Button -->
            <button id="near-me-button" class="w-full flex items-center justify-center space-x-2 bg-[var(--surface-light)] hover:bg-[var(--surface-elevated)] text-[var(--text-primary)] font-semibold py-3 px-4 rounded-lg transition-all duration-150 text-sm border border-[var(--border-color)] hover:border-[var(--brand-blue)]">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2v20M2 12h20"></path>
                    <circle cx="12" cy="12" r="9"></circle>
                </svg>
                <span>Find Nearby Mics</span>
            </button>

            <!-- Day Pills -->
            <div>
                <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2.5">Filter by day</label>
                <div id="day-pill-container" class="grid grid-cols-4 gap-2">
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="">Any</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Monday">Mon</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Tuesday">Tue</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Wednesday">Wed</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Thursday">Thu</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Friday">Fri</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Saturday">Sat</button>
                    <button class="day-pill py-2 px-2 rounded-lg text-xs font-medium" data-day="Sunday">Sun</button>
                </div>
            </div>

            <!-- Time Filter -->
            <div>
                <label class="block text-sm font-medium text-[var(--text-secondary)] mb-2.5">Filter by time</label>
                <div id="time-filter-container" class="grid grid-cols-3 gap-2">
                    <button class="time-filter-btn py-2 px-3 rounded-lg text-sm font-medium" data-time="all">All</button>
                    <button class="time-filter-btn py-2 px-3 rounded-lg text-sm font-medium" data-time="afternoon">Afternoon</button>
                    <button class="time-filter-btn py-2 px-3 rounded-lg text-sm font-medium" data-time="evening">Evening</button>
                </div>
            </div>

            <!-- Borough Filter -->
            <div>
                <label for="borough-filter" class="block text-sm font-medium text-[var(--text-secondary)] mb-2.5">Borough</label>
                <select id="borough-filter" class="w-full px-4 py-3 rounded-lg bg-[var(--surface-light)] border border-[var(--border-color)] text-[var(--text-primary)] text-sm focus:border-[var(--brand-blue)] transition-colors">
                    <option value="">All Boroughs</option>
                    <option value="Manhattan">Manhattan</option>
                    <option value="Brooklyn">Brooklyn</option>
                    <option value="Queens">Queens</option>
                    <option value="Bronx">Bronx</option>
                    <option value="Staten Island">Staten Island</option>
                </select>
            </div>

            <!-- Neighborhood Filter -->
            <div>
                <label for="neighborhood-filter" class="block text-sm font-medium text-[var(--text-secondary)] mb-2.5">Neighborhood</label>
                <select id="neighborhood-filter" class="w-full px-4 py-3 rounded-lg bg-[var(--surface-light)] border border-[var(--border-color)] text-[var(--text-primary)] text-sm focus:border-[var(--brand-blue)] transition-colors">
                    <option value="">All Neighborhoods</option>
                </select>
            </div>

            <!-- Cost Filter -->
            <div>
                <label for="cost-filter" class="block text-sm font-medium text-[var(--text-secondary)] mb-2.5">Price range</label>
                <select id="cost-filter" class="w-full px-4 py-3 rounded-lg bg-[var(--surface-light)] border border-[var(--border-color)] text-[var(--text-primary)] text-sm focus:border-[var(--brand-blue)] transition-colors">
                    <option value="">All Prices</option>
                    <option value="free">Free</option>
                    <option value="under10">Under $10</option>
                    <option value="10-20">$10 - $20</option>
                    <option value="over20">Over $20</option>
                </select>
            </div>

            <!-- Favorites Only Checkbox -->
            <div class="flex items-center space-x-2.5 pt-1">
                <input type="checkbox" id="favorites-only" class="w-4 h-4 text-[var(--brand-blue)] bg-[var(--surface-light)] border-[var(--border-color)] rounded focus:ring-2 focus:ring-[var(--brand-blue)] focus:ring-offset-0 cursor-pointer">
                <label for="favorites-only" class="text-sm font-medium text-[var(--text-primary)] cursor-pointer">Show favorites only</label>
            </div>

            <!-- Clear Filters Button -->
            <button id="clear-filters" class="w-full bg-[var(--surface-light)] hover:bg-[var(--surface-elevated)] text-[var(--text-secondary)] hover:text-[var(--text-primary)] font-semibold py-3 px-4 rounded-lg transition-all duration-150 text-sm border border-[var(--border-color)] hover:border-[var(--text-tertiary)]">
                Clear All Filters
            </button>
        </div>

        <!-- ============================================================== -->
        <!-- ACTIVE FILTER CHIPS -->
        <!-- ============================================================== -->
        <div id="filter-chips-container" class="px-6 py-3 border-b border-[var(--border-color)]">
            <!-- Filter chips will be dynamically inserted here -->
        </div>

        <!-- ============================================================== -->
        <!-- MIC LIST -->
        <!-- ============================================================== -->
        <div id="mic-list" class="px-6 py-5 space-y-4">
            <!-- Mic cards will be dynamically inserted here -->
        </div>
    </div>

    <!-- ================================================================== -->
    <!-- MAP VIEW (Right Panel) -->
    <!-- ================================================================== -->
    <div id="map-view" class="absolute lg:relative top-0 left-0 right-0 bottom-0 w-full h-full z-0"></div>

    <!-- ================================================================== -->
    <!-- VIEW TOGGLE (Mobile Only) -->
    <!-- ================================================================== -->
    <div id="view-toggle" class="fixed bottom-4 right-4 z-[1000] lg:hidden">
        <button id="view-toggle-btn" class="flex items-center space-x-2 bg-[var(--brand-blue)] hover:bg-[var(--brand-blue-hover)] text-white font-bold py-3 px-5 rounded-full shadow-2xl transition-all duration-200 transform hover:scale-105">
            <span id="toggle-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                    <path fill-rule="evenodd" d="M9.69 18.933l.97 1.03c.19.2.49.2.69 0l7.78-8.25a.75.75 0 000-1.06L11.35 2.4a.75.75 0 00-1.06 0L2.5 10.65a.75.75 0 000 1.06l7.19 7.22z" clip-rule="evenodd"></path>
                </svg>
            </span>
            <span id="toggle-text">Map</span>
        </button>
    </div>

</div>

<!-- ======================================================================= -->
<!-- JAVASCRIPT FILES - Load in order -->
<!-- ======================================================================= -->

<!-- Papa Parse for CSV parsing (required for Google Sheets sync) -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<script src="js/config.js"></script>
<script src="js/api-client.js"></script>
<script src="js/data.js"></script>
<script src="js/state.js"></script>
<script src="js/utils.js"></script>
<script src="js/ui.js"></script>
<script src="js/map.js"></script>
<script src="js/sheets-sync.js"></script>
<script src="js/app.js"></script>

</body>
</html>
